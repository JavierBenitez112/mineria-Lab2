library(ggplot2)
library(dplyr)
library(nortest)
movies <- read.csv("../Movies_2026.csv")
movies$releaseDate <- as.Date(movies$releaseDate, format = "%Y-%m-%d")
# Obtener las 20 películas más recientes
peliculas_recientes <- movies |>
arrange(desc(releaseDate)) |>
head(20)
genres  <- c("genres")
movies_separated <- movies |>
tidyr::separate_rows(genres, sep = "\\|")
datos_generos <- movies_separated[, genres]
head(datos_generos, 5)
tabla_freq <- function(col) {
as.data.frame(table(col), stringsAsFactors = FALSE) |>
setNames(c("genero", "frecuencia"))
}
lapply(datos_generos, tabla_freq)
movies$releaseDate <- as.Date(movies$releaseDate, format = "%Y-%m-%d")
# Obtener las 20 películas más recientes
# example
#head(df_1[order(df_1$budget, decreasing = TRUE),"title"], n  = 10)
peliculas_recientes <- movies[order(movies$releaseDate, decreasing = TRUE), ][1:20, ]
peliculas_recientes
# Obtener las 20 películas más recientes
# example
#head(df_1[order(df_1$budget, decreasing = TRUE),"title"], n  = 10)
movies$releaseDate <- as.Date(movies$releaseDate, format = "%Y-%m-%d")
peliculas_recientes <- movies[order(movies$releaseDate, decreasing = TRUE), ][1:20, ]
genres  <- c("genres")
movies_separated <- peliculas_recientes |>
tidyr::separate_rows(genres, sep = "\\|")
datos_generos <- movies_separated[, genres]
head(datos_generos, 5)
tabla_freq <- function(col) {
as.data.frame(table(col), stringsAsFactors = FALSE) |>
setNames(c("genero", "frecuencia"))
}
lapply(datos_generos, tabla_freq)
number_of_actors <- movies |>
tidyr::separate_rows(actors, sep = "\\|") |>
group_by(title) |>
summarise(actorsAmount = n())
with(movies, plot(number_of_actors, revenue))
number_of_actors <- movies_all |>
tidyr::separate_rows(actors, sep = "\\|") |>
group_by(title) |>
summarise(actorsAmount = n(), .groups = "drop")
movies_with_actors <- movies_all |>
left_join(number_of_actors, by = "title")
number_of_actors <- movies |>
tidyr::separate_rows(actors, sep = "\\|") |>
group_by(title) |>
summarise(actorsAmount = n(), .groups = "drop")
movies_with_actors <- movies |>
left_join(number_of_actors, by = "title")
plot(movies_with_actors$actorsAmount, movies_with_actors$revenue,
main = "Relación entre número de actores e ingresos",
xlab = "Número de actores",
ylab = "Ingresos")
number_of_actors <- movies |>
tidyr::separate_rows(actors, sep = "\\|") |>
group_by(title) |>
summarise(actorsAmount = n(), .groups = "drop")
number_of_actors
movies_with_actors <- movies |>
left_join(number_of_actors, by = "title")
movies_with_actors
ggplot(movies_with_actors, aes(x = actorsAmount, y = revenue)) +
geom_point() +
labs(title = "Relación entre la cantidad de actores y los ingresos de las películas",
x = "Cantidad de actores",
y = "Ingresos") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = actorsAmount, y = revenue)) +
geom_point() +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = number_of_actors, y = revenue)) +
geom_point() +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
movies_with_actors
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = actorsAmount, y = revenue)) +
geom_point() +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = actorsAmount, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
with(movies_with_actors, plot(revenue, actorsAmount.y))
# dispersión de cantidad de actores vs revenue
with(movies_with_actors, plot(actorsAmount.y, revenue))
# cantidad de actores por año
ggplot(movies_with_actors, aes(x = releaseYear, y = actorsAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores por Año",
x = "Año de Lanzamiento",
y = "Cantidad de Actores") +
theme_minimal()
# cantidad de actores por año
ggplot(movies_with_actors, aes(x = releaseYear, y = actorsAmount.y)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores por Año",
x = "Año de Lanzamiento",
y = "Cantidad de Actores") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = actorsAmount.y, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = revenue, y = actorsAmount.y)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
theme_minimal()
ggplot(movies_with_actors, aes(x = releaseYear, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores por Año",
x = "Año de Lanzamiento",
y = "Cantidad de Actores") +
theme_minimal()
ggplot(movies_with_actors, aes(x = releaseYear, y = castWomenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores por Año",
x = "Año de Lanzamiento",
y = "Cantidad de Actores") +
theme_minimal()
ggplot(movies_with_actors, aes(x = revenue, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por revenue",
x = "Revenue",
y = "Cantidad de Actores Hombre") +
theme_minimal()
ggplot(movies_with_actors, aes(x = castMenAmount, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por revenue",
x = "Cantidad de Actores Hombre",
y = "Revenue") +
theme_minimal()
ggplot(movies_with_actors, aes(x = castMenAmount, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por revenue",
x = "Revenue",
y = "Cantidad de Actores Hombre") +
theme_minimal()
library(scales)
ggplot(movies_with_actors, aes(x = revenue, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por revenue",
x = "Revenue",
y = "Cantidad de Actores Hombre") +
scale_x_continuous(labels = label_number(big.mark = ",", scientific = FALSE)) +
scale_y_continuous(labels = label_number(big.mark = ",", scientific = FALSE)) +
theme_minimal()
ggplot(movies_with_actors, aes(x = revenue, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por revenue",
x = "Revenue",
y = "Cantidad de Actores Hombre") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
# cantidad de actores por año
ggplot(movies_with_actors, aes(x = releaseYear, y = actorsAmount.y)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores por Año",
x = "Año de Lanzamiento",
y = "Cantidad de Actores") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
# dispersión de cantidad de actores vs revenue
ggplot(movies_with_actors, aes(x = actorsAmount.y, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores vs Ingresos de las Películas",
x = "Cantidad de Actores",
y = "Ingresos (Revenue)") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
ggplot(movies_with_actors, aes(x = castWomenAmount, y = revenue)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Mujer por revenue",
x = "Revenue",
y = "Cantidad de Actores Mujer") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
ggplot(movies_with_actors, aes(x = popularity, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por popularity",
x = "Popularity",
y = "Cantidad de Actores Hombre") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
ggplot(movies_with_actors, aes(x = popularity, y = castMenAmount)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Hombre por popularity",
x = "Cantidad de Actores Hombre",
y = "Popularity") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
ggplot(movies_with_actors, aes(x = castWomenAmount, y = popularity)) +
geom_point(na.rm = TRUE) +
labs(title = "Cantidad de Actores Mujer por popularity",
x = "Cantidad de Actores Mujer",
y = "Popularity") +
scale_x_continuous(labels = comma) +
scale_y_continuous(labels = comma) +
theme_minimal()
top_rated_movies <- movies |>
arrange(desc(voteAvg)) |>
head(20) |>
select(director, title, voteAvg)
top_rated_movies
knitr::opts_chunk$set(echo = TRUE)
movies <- read.csv("datasets/Movies_2026.csv")
library(lubridate)
