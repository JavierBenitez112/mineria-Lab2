---
title: "Analisis Exploratorio"
author: "Javier Benitez"
date: "2026-02-02"
output: pdf_document
---

```{r setup, include=FALSE}
library(nortest)
library(lubridate)
library(ggplot2)
library(dplyr)
library(scales)

movies <- read.csv("Movies_2026.csv")

head(movies
, 5)

# Actors y Actors characters van aqui
cual_nominales <- c(
  "genres",
  "homePage",
  "productionCompany",
  "productionCompanyCountry",
  "productionCountry",
  "video",
  "director",
  "originalTitle",
  "title",
  "originalLanguage"
)

cual_ordinales <- c(
  "releaseDate"
)


cuant_discretas <- c(
  "id",
  "budget",
  "revenue",
  "runtime",
  "voteAvg",
  "voteCount",
  "genresAmount",
  "productionCoAmount",
  "productionCountriesAmount",
  "actorsAmount",
  "castWomenAmount",
  "castMenAmount",
  "releaseYear"
)

# actors popularity va en cauantitativo de continuas
cuant_continuas <- c(
  "popularity"
)

cuantitativas <- c(cuant_discretas, cuant_continuas)
cuantitativas
datos_cuant <- movies[, cuantitativas]
head(datos_cuant, 5)

cualitativas <- c(cual_nominales, cual_ordinales)
cualitativas
datos_cual <- movies[, cualitativas]
head(datos_cual, 5)

lillie_results <- lapply(datos_cuant, lillie.test)
lillie_results

frec <- table(unlist(datos_cual))

par(mar = c(5, 12, 4, 2))

# Ciclo para graficar cada variable cualitativa por separado
for (variable in cualitativas) {
  
  # 1. Crear tabla de frecuencia para la variable actual
  tabla <- table(movies[[variable]])
  
  # 2. Ordenar de mayor a menor
  tabla <- sort(tabla, decreasing = TRUE)
  
  # 3. Validar si son demasiados datos (ej. Titulos) para mostrar solo el Top 20
  if (length(tabla) > 20) {
    tabla_graficar <- tabla[1:20]
    subtitulo <- "(Top 20 más frecuentes)"
  } else {
    tabla_graficar <- tabla
    subtitulo <- "(Todos los valores)"
  }
  
  # 4. Generar el gráfico
  # Usamos 'horiz = TRUE' porque es más fácil leer nombres largos de lado
  barplot(tabla_graficar,
          main = paste("Variable:", variable, subtitulo),
          col = "skyblue",
          horiz = TRUE,      # Barras horizontales
          las = 1,           # Las etiquetas siempre horizontales
          cex.names = 0.6    # Tamaño de letra un poco más pequeño
  )
}


```

```{r}
with(movies, plot(budget,revenue))
```
##¿Cómo se correlacionan los presupuestos con los ingresos? ¿Los altos presupuestos significan altos ingresos?

En este caso como se puede observar en la grafica hay muchos datos irregulares que no siguen ninguna tendecia evidente por lo que se puede decir que entre estos 2 datos los presupuestos e ingresos no estan relacionados directamente

```{r}
movies$releaseDate <- as.Date(movies$releaseDate)
movies$mes <- month(movies$releaseDate, label = TRUE, abbr = TRUE)

# 3. AGREGACIÓN (Recomendado)
# Si tienes muchas películas en un mes, es mejor sumar los ingresos 
# para ver el total mensual en lugar de puntos individuales encimados.
df_mensual <- movies %>%
  group_by(mes) %>%
  summarize(total_revenue = sum(revenue, na.rm = TRUE))

# 4. GRÁFICO FINAL
ggplot(df_mensual, aes(x = mes, y = total_revenue, group = 1)) +
  # Usamos una sombra para el volumen
  geom_area(fill = "steelblue", alpha = 0.3) + 
  # Cambiamos 'size' por 'linewidth' para evitar el Warning
  geom_line(color = "steelblue", linewidth = 1) + 
  geom_point(color = "steelblue", size = 2) +
  # Formateo de etiquetas
  labs(
    title = "Evolución de Ingresos por Mes de Lanzamiento",
    subtitle = "Tendencia estacional de ingresos totales",
    x = "Mes",
    y = "Ingresos Totales (Suma)"
  ) +
  theme_minimal()
```

##¿Se asocian ciertos meses de lanzamiento con mejores ingresos?

Si como se puede observar en la grafica si hay ciertos meses en los que hay lanzamientos que obtienen mas ingresos a diferencia de los otros meses entonces los mejores meses para lanzar una pelicula es en Julio y en Diciembre

```{r}

movies_clean <- movies %>%
  mutate(
    date = as.Date(releaseDate),
    mes = month(date, label = TRUE, abbr = TRUE),
    anio = year(date)
  ) %>%
  filter(!is.na(mes))
# 2. Calcular métricas: Ingresos totales y promedio de pelis por mes
# Primero contamos cuántas pelis hay por cada Mes-Año específico
conteo_mensual <- movies_clean %>%
  group_by(anio, mes) %>%
  summarise(n_pelis = n(), revenue_total = sum(revenue, na.rm = TRUE), .groups = "drop")

# Ahora promediamos esos conteos por cada mes
metricas_finales <- conteo_mensual %>%
  group_by(mes) %>%
  summarise(
    promedio_lanzamientos = mean(n_pelis),
    ingresos_totales = sum(revenue_total)
  )

# 3. GRÁFICO A: Ingresos Totales por Mes
g1 <- ggplot(metricas_finales, aes(x = mes, y = ingresos_totales, fill = ingresos_totales)) +
  geom_col() +
  scale_fill_viridis_c(option = "magma", guide = "none") +
  labs(title = "Meses con Mejores Ingresos", y = "Ingresos Totales", x = "") +
  theme_minimal()

g2 <- ggplot(metricas_finales, aes(x = mes, y = promedio_lanzamientos)) +
  geom_col(fill = "steelblue") +
  # Añade el número exacto de películas promedio sobre la barra
  geom_text(aes(label = round(promedio_lanzamientos, 1)), 
            vjust = -0.5, size = 3.5) +
  labs(
    title = "Promedio de Películas Lanzadas por Mes",
    subtitle = "¿Cuántas películas se estrenan realmente en un mes típico?",
    x = "Mes",
    y = "Cant. Promedio de Estrenos"
  ) +
  theme_minimal()

# Visualizar los gráficos
print(g1)
print(g2)
```
##¿En qué meses se han visto los lanzamientos con mejores ingresos?¿cuantas películas, en promedio, se han lanzado por mes?

Junio es el mes con mejores ingresos y en promedio se lanzan 25.23 peliculas por mes.

```{r}
ggplot(movies, aes(x = voteAvg, y = revenue)) +
  # A. Puntos (Scatter plot)
  geom_point(color = "steelblue", alpha = 0.6, size = 3) +
  
  # B. Línea de tendencia (Suavizado o Lineal)
  # Usa method = "lm" para una línea recta (regresión lineal)
  # Usa method = "loess" para una curva suavizada flexible
  geom_smooth(method = "lm", color = "darkred", se = TRUE) +
  
  # C. Etiquetas y tema
  labs(
    title = "Correlación: Calificaciones vs. Éxito Comercial",
    subtitle = "Análisis de impacto de las reseñas en los ingresos",
    x = "Calificación (0-10)",
    y = "Ingresos Totales ($)",
    caption = "Fuente: Datos simulados"
  ) +
  theme_minimal()
```
##¿Cómo se correlacionan las calificaciones con el éxito comercial?

Las peliculas entre los 7.5 de calificacion son las peliculas que mas ingresos tienen pero hay muchas peliculas que son un 10 total pero que no generaron apenas ingresos y de igual manera peliculas con una puntuacion de 7.5 podrian no haber generado ningun ingreso no es garantizado un gran ingreso pero si es mas probable

```{r}
peliculas_clean <- movies %>%
  mutate(
    # Transformamos la URL a una categoría simple
    # !is.na() verifica que no sea nulo
    # homePage != "" verifica que no esté vacío el texto
    tiene_web = ifelse(!is.na(homePage) & homePage != "", "Con Página Oficial", "Sin Página Oficial"),
    
    # Transformamos el TRUE/FALSE a texto legible
    tiene_video = ifelse(video == TRUE, "Con Video Promo", "Sin Video Promo")
  )

# 3. GRAFICAR (Usando las nuevas variables transformadas)
ggplot(peliculas_clean, aes(x = tiene_web, y = revenue, fill = tiene_video)) +
  
  # Usamos Boxplot
  geom_boxplot(alpha = 0.7) +
  
  # Escala logarítmica (Vital para revenue)
  scale_y_log10(labels = scales::dollar_format()) +
  
  # Personalización
  labs(
    title = "Impacto de la Página Web y Video en Ingresos",
    subtitle = "¿Vale la pena invertir en sitio web y trailer?",
    x = "Presencia de Sitio Web",
    y = "Ingresos (Escala Log)",
    fill = "Video Promocional"
  ) +
  theme_minimal()
```
##¿Qué estrategias de marketing, como videos promocionales o páginas oficiales, generan mejores resultados?

Las peliculas con pagina oficial tienen mas revenue por ende el sitio web es mejor estrategia

```{r}
with(movies, plot(revenue,actorsPopularity))
```
##¿La popularidad del elenco está directamente correlacionada con el éxito de taquilla?

No como se puede ver en esta grafica no esta directamente relacionada la popularidad de un actor con el ingreso de la pelicula
